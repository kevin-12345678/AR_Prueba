<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Explorador de Realidad Aumentada</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}" />
</head>
<body>
  <div class="app">

    <!-- interfaz de bienvenida -->
    <section id="ar-interface" class="hero-section">
      <h1>Explorador de Realidad Aumentada</h1>
      <p>Descubre un mundo mágico superpuesto a tu realidad</p>

      <div id="error-message" class="error-message" style="display: none;"></div>

      <button id="start-btn" class="camera-button">
        <span class="button-icon">🔮</span>
        <span class="button-text">Activar Magia AR</span>
      </button>

      <div class="feature-list">
        <div class="feature"><div class="feature-icon">👤</div><p>Filtros faciales</p></div>
        <div class="feature"><div class="feature-icon">🦄</div><p>Criaturas mágicas</p></div>
        <div class="feature"><div class="feature-icon">🏠</div><p>Ventanas animadas</p></div>
        <div class="feature"><div class="feature-icon">🌿</div><p>Flora interactiva</p></div>
        <div class="feature"><div class="feature-icon">🔲</div><p>Escaneo QR</p></div>
      </div>
    </section>

    <!-- contenedor de la experiencia AR -->
    <div id="ar-container" style="display: none;">
      <div class="camera-feed ar-view">

        <!-- ✅ VIDEO de cámara -->
        <video id="camera-video"
               class="camera-video"
               autoplay
               playsinline
               muted>
        </video>

        <!-- ✅ FILTRO alienígena fuera del video -->
        <img 
          id="alien-filter" 
          class="alien-filter" 
          src="{{ url_for('static', filename='img/Filtroalien.png') }}" 
          style="display: none;" 
        />

        <!-- Placeholder -->
        <div id="camera-placeholder" class="camera-placeholder">
          <div class="placeholder-content">
            <div class="placeholder-icon">📷</div>
            <div class="placeholder-text">Cámara no disponible</div>
          </div>
        </div>

        <!-- Filtro facial (emoji + texto) -->
        <div id="face-effect" class="face-effect" style="display: none;">
          <div class="effect-icon" id="effect-icon"></div>
          <div class="effect-name" id="effect-name"></div>
        </div>

        <!-- Criatura aleatoria -->
        <div id="random-creature" class="random-creature" style="display: none;">
          <div class="creature-icon" id="creature-icon"></div>
          <div class="creature-info">
            <div class="creature-name" id="creature-name"></div>
            <div class="creature-action" id="creature-action"></div>
          </div>
        </div>

        <!-- Ventana animada / QR -->
        <div id="window-animation" class="window-animation" style="display: none;">
          <div class="window-frame">
            <div class="animation-element">🎭</div>
            <div class="animation-text">¡Espectáculo en vivo!</div>
          </div>
        </div>

        <!-- Planta + animal -->
        <div id="plant-animal" class="plant-animal" style="display: none;">
          <div class="plant-icon">🌿</div>
          <div class="animal-icon" id="animal-icon"></div>
          <div class="animal-name" id="animal-name"></div>
        </div>
      </div>

      <button id="exit-btn" class="exit-button">Salir de la Experiencia AR</button>
    </div>

  </div>

  <!-- Overlay de carga -->
  <div id="loading-overlay" class="loading-overlay" style="display: none;">
    <div class="loading-content">
      <div class="spinner"></div>
      <p>Cargando magia AR...</p>
    </div>
  </div>

  <!-- Carga de scripts -->
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.7.4"></script>
  <script src="https://cdn.jsdelivr.net/npm/face-api.js@0.22.2/dist/face-api.min.js"></script>
  <script src="https://unpkg.com/jsqr/dist/jsQR.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/coco-ssd"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

  <!-- Tu lógica final -->
  <script src="{{ url_for('static', filename='js/ar_logic.js') }}"></script>
</body>
</html>
